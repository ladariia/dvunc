import React, { useContext } from 'react';
import { Context } from '../index'
import Container from 'react-bootstrap/Container';
import { NavLink, useNavigate } from 'react-router-dom';
import { COURSES_ROUTE, LOGIN_ROUTE, ADMIN_ROUTE } from '../utils/consts';
import { Button, Navbar, Nav } from 'react-bootstrap';
import { observer } from 'mobx-react-lite';

//observer-для перерендера в режиме реального времени, чтобы mobx мог отслеживать изменения занчений в состоянии
const NavBar = observer(() => {
    const { user } = useContext(Context)
    const navigate = useNavigate()

    const logOut = () => {
        user.setUser({})
        user.setIsAuth(false)
        localStorage.removeItem('token')
        navigate(COURSES_ROUTE)
    }

    return (
        <Navbar bg="dark" variant="dark" style={{
            height: 80, position: 'fixed', width: '100%', top: 0, left: 0, zIndex: 1
        }}>
            <Container>
                <NavLink style={{ color: 'white', textDecoration: 'none' }} to={COURSES_ROUTE}>
                    <svg height="13" viewBox="0 0 817 141" fill="none" xmlns="http://www.w3.org/2000/svg">
                        <path d="M121.4 29C124 29 126 31 126 33.6V108.4C126 111 124 113 121.4 113H46.6C44 113 42 111 42 108.4V33.6C42 31 44 29 46.6 29H121.4ZM14 108.4C14 111 12 113 9.4 113H4.6C2 113 0 115 0 117.6V136.4C0 139 2 141 4.6 141H163.4C166 141 168 139 168 136.4V117.6C168 115 166 113 163.4 113H158.6C156 113 154 111 154 108.4V29C154 13.6 141.4 0.99999 126 0.99999H42C26.6 0.99999 14 13.6 14 29V108.4ZM214.475 113C211.875 113 209.875 111 209.875 108.4V89.6C209.875 87 211.875 85 214.475 85H289.275C291.875 85 293.875 87 293.875 89.6V108.4C293.875 111 291.875 113 289.275 113H214.475ZM214.475 57C211.875 57 209.875 55 209.875 52.4V33.6C209.875 31 211.875 29 214.475 29H289.275C291.875 29 293.875 31 293.875 33.6V52.4C293.875 55 291.875 57 289.275 57H214.475ZM181.875 113C181.875 128.4 194.475 141 209.875 141H293.875C309.275 141 321.875 128.4 321.875 113V95C321.875 88.6 319.275 82.4 314.875 78L307.875 71L314.875 64C319.275 59.6 321.875 53.4 321.875 47V29C321.875 13.6 309.275 0.99999 293.875 0.99999H209.875C194.475 0.99999 181.875 13.6 181.875 29V113ZM342.031 5.59999V57C342.031 72.4 354.631 85 370.031 85H449.431C452.031 85 454.031 87 454.031 89.6V108.4C454.031 111 452.031 113 449.431 113H360.631C358.031 113 356.031 115 356.031 117.6V136.4C356.031 139 358.031 141 360.631 141H454.031C469.431 141 482.031 128.4 482.031 113V5.59999C482.031 2.99999 480.031 0.99999 477.431 0.99999H458.631C456.031 0.99999 454.031 2.99999 454.031 5.59999V52.4C454.031 55 452.031 57 449.431 57H374.631C372.031 57 370.031 55 370.031 52.4V5.59999C370.031 2.99999 368.031 0.99999 365.431 0.99999H346.631C344.031 0.99999 342.031 2.99999 342.031 5.59999ZM501.992 136.2C501.992 138.8 503.992 140.8 506.592 140.8H525.392C527.992 140.8 529.992 138.8 529.992 136.2V89.4C529.992 86.8 531.992 84.8 534.592 84.8H609.392C611.992 84.8 613.992 86.8 613.992 89.4V136.2C613.992 138.8 615.992 140.8 618.592 140.8H637.392C639.992 140.8 641.992 138.8 641.992 136.2V5.39999C641.992 2.79999 639.992 0.799993 637.392 0.799993H618.592C615.992 0.799993 613.992 2.79999 613.992 5.39999V52.2C613.992 54.8 611.992 56.8 609.392 56.8H534.592C531.992 56.8 529.992 54.8 529.992 52.2V5.39999C529.992 2.79999 527.992 0.799993 525.392 0.799993H506.592C503.992 0.799993 501.992 2.79999 501.992 5.39999V136.2ZM662.148 5.59999V113C662.148 128.4 674.748 141 690.148 141H811.548C814.148 141 816.148 139 816.148 136.4V117.6C816.148 115 814.148 113 811.548 113H806.748C804.148 113 802.148 111 802.148 108.4V5.59999C802.148 2.99999 800.148 0.99999 797.548 0.99999H778.748C776.148 0.99999 774.148 2.99999 774.148 5.59999V108.4C774.148 111 772.148 113 769.548 113H694.748C692.148 113 690.148 111 690.148 108.4V5.59999C690.148 2.99999 688.148 0.99999 685.548 0.99999H666.748C664.148 0.99999 662.148 2.99999 662.148 5.59999Z" fill="white" />
                    </svg>
                </NavLink>
                {user.isAuth ?
                    <Nav className="ml-auto">
                        <Button style={{ borderRadius: 30 }} variant={"outline-light"} onClick={() => navigate(ADMIN_ROUTE)}>Админ</Button>
                        <Button style={{ borderRadius: 30, marginLeft: 4 }} variant={"outline-light"} onClick={() => logOut()}>Выйти</Button>
                    </Nav>
                    :
                    <Nav className="ml-auto">
                        <Button style={{ borderRadius: 30 }} variant={"outline-light"} onClick={() => navigate(LOGIN_ROUTE)}>Войти</Button>
                    </Nav>
                }
            </Container>
        </Navbar >
    );
});

export default NavBar;